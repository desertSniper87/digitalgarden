---
{"dg-publish":true,"permalink":"/android-exploits/"}
---

## [[Static malware analysis\|Static]] analysis of [[apk\|apk]]

- https://mobsf.live/
- [[jadx\|jadx]]
- [[logcat\|logcat]]

## POC

- https://github.com/0xArab/diva-apk-file


Mobile applications and services are vital for both our personal and professional life, making them prime targets for malicious actors seeking sensitive data. Modern Android applications are widely used in commerce, healthcare, banking, education, and more. Beyond storing sensitive information, these applications often contain security vulnerabilities that could be exploited. Penetration testers and developers play a crucial role in identifying and mitigating these vulnerabilities, reducing risks such as fraud, malware infections, and data breaches. For companies launching new applications, ensuring security and compliance is essential to avoiding legal issues and protecting user data.

Mobile application penetration testing is the process of assessing an app's security by simulating real-world attack scenarios. This methodology helps identify vulnerabilities and ensures that applications remain resilient against threats. The following steps outline a structured, high-level approach that Android penetration testers should follow for a comprehensive security evaluation.

#### 1. Planning and Environment Setup

|**Objectives**|
|---|
|Define the scope and objectives of the penetration test.|
|Obtain necessary permissions from the app owner or organization.|
|Set up the testing environment, including the necessary tools, operating systems, and emulators.|

#### 2. Enumeration and Information Gathering

|**Objectives**|
|---|
|Gather information about the app and its architecture.|
|Understand the functionality of the application.|
|Enumerate any data structure the app uses that is stored in the local storage.|

#### 3. Static Analysis

|**Objectives**|
|---|
|Understand the manifest file of the application. Review the app's components, permissions, and configurations.|
|Decompile and analyze the application's source code to understand the flow and find potential vulnerabilities.|
|Examine native or third-party libraries, frameworks, and dependencies the app uses.|

#### 4. Dynamic Analysis

|**Objectives**|
|---|
|Monitor the application's behavior during runtime. Enumerate the local storage for files and data structures created after performing various functionalities.|
|Perform dynamic instrumentation to read the memory of the application during runtime.|
|Intercept network traffic and test the app for vulnerabilities such as authentication bypass and insecure data transmission.|
|Check for Server-Side attacks by analyzing API calls and looking for vulnerabilities such as injection and XSS attacks.|

#### 5. Documenting and Reporting

|**Objectives**|
|---|
|Document the identified vulnerabilities, exploitation methods, impact, and potential risks.|
|Communicate the findings to the app owner or organization.|
|Provide recommendations for fixing vulnerabilities and mitigating security risks.|

---

## Suggested Tools

The following list presents some of the most widely used tools for mobile app penetration testing , focusing on `reverse engineering`, `dynamic analysis`, `code instrumentation`, `network traffic analysis`, and `digital forensics`. Familiarity with these tools is essential for anyone practicing their Android application penetration testing skills.

#### ADB

A versatile command-line tool that allows communication with Android devices. This tool will let us enumerate the local storage of the device and the installation directory of the application, see the app logs while it is running, and install and run other apps and tools necessary for the steps of the dynamic analysis and instrumentation.

#### JADX

This tool allows us to reverse engineer an application and view its source code through a graphical interface. It provides the user with a Java-like pseudocode that is close enough to the actual code. It also decodes the encoded resources that are packed in the APK file, making the file configurations and the other assets readable to humans. This tool is an essential part of the process since the testers can understand how the app works and what technologies are used.

#### APKTool

This tool also allows reverse engineering Android applications. It will decompile the source code and decode the resources of the APK file. APKTool also enables us to edit the source code and configuration files, recompile the code, and build the APK file again. This is called application patching. The decompiled code provided to the user is a symbolic language called `Smali`. This language is not easy to read, but if combined with a tool that offers Java-like pseudocode like JADX, pentesters can efficiently understand and change the flow of the application to their benefit.

#### Ghidra

An open-source software reverse engineering (SRE) framework developed by the National Security Agency (NSA). It is used for disassembling, decompiling, and analyzing binaries. In Android application penetration testing, Ghidra is often used to analyze the native C++ libraries loaded to the application.

#### Burp Suite

A tool used for web application penetration testing. While we often see it used for testing websites, it can also be used for testing any web-based application communicating with a server, including Android. In the Android application, penetration testing will be mainly used to intercept and analyze HTTP/HTTPS requests.

#### Frida

A dynamic instrumentation toolkit used by developers, reverse engineers, and security researchers. It enables us to inject snippets of JavaScript or native code into the running processes of Android applications, allowing us to analyze and manipulate them during runtime.

#### Autopsy

An open-source digital forensics platform that can be used for various tasks, including Android forensics. Autopsy will help us investigate disk images of Android devices and let us search for files, databases, calls, messages, and logs, using the provided GUI.

---

## Automated Tools

Automated Android penetration testing tools are suitable for scanning common vulnerabilities. They offer a faster and cheaper solution than manual tools and processes, which provide more depth and vulnerability insights by combining human intelligence with automated tools.

#### MobSF

An automated security testing framework for Android, iOS, and Windows platforms that performs static, dynamic, and malware analysis on mobile applications.

#### Drozer

A comprehensive security and attack framework that allows us to assess the security of Android applications. It simulates various attack vectors and provides multiple tools to analyze, exploit, and debug Android applications.

#### Qark

A static code analysis tool that automates the discovery of security vulnerabilities in Android applications. It can also create Proof-of-Concept deployable APKs and ADB commands to exploit the vulnerabilities it finds.

#### Objection

A runtime mobile exploration toolkit that uses Frida to provide an easy environment for assessing Android and iOS application security. It automates several common tasks, such as bypassing SSL pinning, and users won't be needed to create custom scripts whenever they need to exploit common vulnerabilities.

#### Medusa

An extensible and modularized framework that automates processes and techniques practiced during the dynamic analysis of Android Applications. Medusa is based on Frida and can analyze and enumerate an app, attack common entry points, and automate processes like application patching, MITM attack, and more. Medusa can add and remove hooks for Java or Native methods and has more than 90 modules that can be combined.

#### Androbugs

Androbugs is an Android vulnerability analysis framework that automatically scans Android applications and checks for security issues and vulnerabilities.

It is crucial to remember that combining both manual and automated techniques usually results in a better evaluation. Recapping this module, we went through the most critical fundamental concepts necessary for understanding the methodologies that will follow in subsequent modules. We analyzed the structure of the Android OS and the architecture of applications, discussed the different types of apps, and examined examples of applications built with various frameworks. We studied their components and IPCs, and learned how to set up a testing environment and interact with emulators.

Following the Penetration Testing methodology discussed in this section, we are now ready to prepare for the next module, which regards Android Application Static Analysis. In this upcoming module, we will reverse engineer apps and study the source code to identify security issues and exploit vulnerabilities.